"use strict";var express=require("express"),morgan=require("morgan"),connectDB=require("./config/db");require("dotenv").config();var rateLimit=require("express-rate-limit"),helmet=require("helmet"),mongoSanitize=require("express-mongo-sanitize"),xss=require("xss-clean"),hpp=require("hpp"),path=require("path"),AppError=require("./utils/appError"),globalErrorHandler=require("./controller/errorController");process.on("uncaughtException",function(e){console.log(e),console.log("UNHANDLER REJECTION! ðŸ’¥ Shutting down..."),process.exit(1)});var app=express();app.set("view engine","pug"),app.set("views",path.join(__dirname,"views")),connectDB(),app.use(helmet()),"development"===process.env.NODE_ENV&&app.use(morgan("dev"));var limiter=rateLimit({max:100,windowMs:36e5,message:"Too many requests from this IP, please try again in an hour! "});app.use("/api",limiter),app.use(express.json({limit:"10kb"})),app.use(mongoSanitize()),app.use(xss()),app.use(hpp({whitelist:["duration","ratingsQuantity","ratingsAverage","difficulty","maxGroupSize","price"]})),app.use(express.static(path.join(__dirname,"public")));var tours=require("./route/tour"),users=require("./route/user"),reviews=require("./route/review"),viewRouter=require("./route/viewRoutes");app.use("/",viewRouter),app.use("/api/v1/tours",tours),app.use("/api/v1/users",users),app.use("/api/v1/reviews",reviews),app.all("*",function(e,r,i){i(new AppError("Can't find ".concat(e.originalUrl," on this server!")))}),app.use(globalErrorHandler);var port=process.env.PORT||5e3,server=app.listen(port,function(){console.log("App running on port:".concat(port,"..."))});process.on("unhandledRejection",function(e){console.log(e),console.log("UNCAUGHT EXCEPTION! ðŸ’¥ Shutting down..."),server.close(function(){process.exit(1)})});
//# sourceMappingURL=server.min.js.map
